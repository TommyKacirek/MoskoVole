<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MikroTik MTCNA - Revidovaný Test</title>
    <style>
        :root {
            --primary: #2d3e50;
            --accent: #2e86de;
            --success: #10ac84;
            --error: #ee5253;
            --bg: #f4f7f6;
            --card-bg: #ffffff;
            --text: #333333;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            display: flex;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            background-color: var(--card-bg);
            width: 100%;
            max-width: 800px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            padding: 30px;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        h1 { color: var(--primary); text-align: center; margin-bottom: 10px; font-size: 1.8rem; }
        .tag { background: #e0e0e0; padding: 2px 8px; border-radius: 4px; font-size: 0.8rem; vertical-align: middle; margin-left: 10px; color: #555; }
        
        /* Progress */
        .progress-container { width: 100%; background-color: #e0e0e0; height: 10px; border-radius: 5px; margin-bottom: 20px; overflow: hidden; }
        .progress-bar { height: 100%; background-color: var(--primary); width: 0%; transition: width 0.3s ease; }
        .stats { display: flex; justify-content: space-between; margin-bottom: 20px; font-size: 0.9rem; color: #666; font-weight: bold; }

        /* Questions */
        .question-text { font-size: 1.25rem; font-weight: 600; margin-bottom: 20px; line-height: 1.4; }
        .options-grid { display: flex; flex-direction: column; gap: 10px; }

        /* Options */
        .option-label {
            display: flex;
            align-items: center;
            background-color: #f8f9fa;
            border: 2px solid #e9ecef;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }
        .option-label:hover { background-color: #e2e6ea; border-color: #ced4da; }
        .option-label input { margin-right: 15px; transform: scale(1.2); }
        
        /* States */
        .option-label.correct { background-color: #d1f2e5; border-color: var(--success); color: #0b7559; }
        .option-label.wrong { background-color: #fadbd8; border-color: var(--error); color: #922b21; }
        .option-label.missed { border-color: var(--success); border-style: dashed; }
        .option-label.disabled { pointer-events: none; opacity: 0.9; }

        /* Feedback */
        .feedback { margin-top: 20px; padding: 15px; border-radius: 8px; background-color: #e8f4fd; border-left: 5px solid var(--primary); display: none; }
        .feedback.show { display: block; animation: fadeIn 0.4s; }

        /* Buttons */
        .controls { margin-top: 25px; display: flex; justify-content: flex-end; gap: 10px; height: 50px; }
        button { border: none; padding: 12px 25px; font-size: 1rem; border-radius: 6px; cursor: pointer; transition: 0.2s; color: white; }
        .check-btn { background-color: var(--accent); display: none; }
        .check-btn:hover { background-color: #1e63a3; }
        .next-btn { background-color: var(--primary); display: none; }
        .next-btn:hover { background-color: #3b526b; }
        .restart-btn { background-color: var(--success); margin-top: 20px; }

        .results-screen { text-align: center; display: none; }
        .score-circle { width: 150px; height: 150px; border-radius: 50%; background: conic-gradient(var(--success) 0%, #e0e0e0 0%); margin: 20px auto; display: flex; align-items: center; justify-content: center; flex-direction: column; font-size: 2rem; font-weight: bold; color: var(--primary); }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div class="container">
    <h1>MTCNA Revize <span id="mode-tag" class="tag">Dle PDF</span></h1>
    
    <div id="quiz-ui">
        <div class="stats">
            <span id="q-counter">Start</span>
            <span id="score-counter">Skóre: 0</span>
        </div>
        <div class="progress-container">
            <div class="progress-bar" id="progress-bar"></div>
        </div>

        <div class="question-box">
            <div class="question-text" id="question-text">Načítání...</div>
            <div class="options-grid" id="options-container"></div>
        </div>

        <div class="feedback" id="feedback-box">
            <p id="feedback-text"></p>
        </div>

        <div class="controls">
            <button class="check-btn" id="check-btn" onclick="submitAnswer()">Zkontrolovat odpověď</button>
            <button class="next-btn" id="next-btn" onclick="nextQuestion()">Další otázka</button>
        </div>
    </div>

    <div id="results-ui" class="results-screen">
        <h2>Test dokončen!</h2>
        <div class="score-circle" id="final-score-circle">
            <div id="final-score">0%</div>
        </div>
        <p id="final-message"></p>
        <button class="restart-btn" onclick="initQuiz()">Spustit znovu</button>
    </div>
</div>

<script>
    /* DATA UPDATE: 
       Questions revised based on 'spravne_odpovedi_mikrotik.pdf'.
       Some questions now support multiple correct answers (type: 'multi').
    */
    const quizData = [
        {
            // PDF Otázka 71
            question: "Máte RouterBOARD v továrním nastavení (bez konfigurace). Jaké jsou možné způsoby připojení pro základní konfiguraci? (Vyberte všechny správné možnosti)",
            type: "multi",
            options: [
                { text: "Serial Connection (Sériový port)", correct: true },
                { text: "MAC-Winbox", correct: true },
                { text: "Attach-monitor/keyboard", correct: false },
                { text: "Telnet", correct: true } // PDF Q71 explicitně označuje Telnet (MAC-Telnet) jako správnou možnost
            ],
            rationale: "Podle PDF (otázka 71) jsou správné možnosti: Serial, MAC-Winbox a Telnet (RouterOS podporuje MAC-Telnet i bez IP)."
        },
        {
            // PDF Otázka 49 / 114
            question: "Co vše může získat MikroTik DHCP klient z DHCP serveru? (Vyberte všechny správné možnosti)",
            type: "multi",
            options: [
                { text: "IP Address and Subnet", correct: true },
                { text: "IP Gateway", correct: true },
                { text: "DNS Server", correct: true },
                { text: "Byte limit", correct: false }
            ],
            rationale: "Podle PDF (otázka 49 a 114) klient přebírá IP, Masku, Bránu (Gateway) a DNS."
        },
        {
            // PDF Otázka 23 / 120
            question: "Která tvrzení o Connection Tracking (sledování spojení) jsou pravdivá? (Vyberte všechny správné možnosti)",
            type: "multi",
            options: [
                { text: "Musí být zapnuto, aby byl Firewall efektivní", correct: true },
                { text: "Musí být zapnuto pro NAT sítě", correct: true },
                { text: "Vypnutí snižuje zátěž CPU", correct: true }, // Technicky pravda, PDF to zmiňuje v kontextu "true for connection tracking"
                { text: "Musí být vypnuto pro Mangle", correct: false }
            ],
            rationale: "PDF (otázka 23) uvádí, že CT musí být zapnuto pro firewall i NAT."
        },
        {
            // PDF Otázka 68
            question: "Co je možné provést pomocí nástroje Netinstall? (Vyberte všechny správné možnosti)",
            type: "multi",
            options: [
                { text: "Instalace MikroTik RouterOS", correct: true },
                { text: "Reinstalace MikroTik RouterOS", correct: true },
                { text: "Reset hesla se zachováním konfigurace", correct: true }, // PDF Q68 explicitně označuje D jako správné
                { text: "Reset konfigurace", correct: true }
            ],
            rationale: "Netinstall je mocný nástroj. PDF potvrzuje instalaci, reinstalaci, reset konfigurace i reset hesla se zachováním konfigurace."
        },
        {
            // PDF Otázka 125
            question: "Vyberte správná tvrzení o MikroTik Web Proxy:",
            type: "multi",
            options: [
                { text: "Provádí HTTP caching", correct: true },
                { text: "Pro transparentní proxy je vyžadováno Destination NAT pravidlo", correct: true },
                { text: "Provádí FTP caching", correct: false } // V PDF Q125 je pouze HTTP caching
            ],
            rationale: "Pro zprovoznění transparentní proxy musíte přesměrovat provoz (dst-nat tcp 80 -> 8080)."
        },
        {
            question: "K čemu slouží Safe Mode ve WinBoxu / konzoli?",
            type: "single",
            options: [
                { text: "Automaticky vrátí změny při ztrátě spojení", correct: true },
                { text: "Zabrání smazání systémových souborů", correct: false },
                { text: "Uvede router do režimu nízké spotřeby", correct: false }
            ],
            rationale: "Funkce chrání před chybou v konfiguraci. Pokud se odpojíte, změny se vrátí."
        },
        {
            // PDF Otázka 209
            question: "DHCP server je nakonfigurován na rozhraní LAN, které je portem v bridgi (slave). DHCP server nestartuje. Proč?",
            type: "single",
            options: [
                { text: "DHCP server nemůže běžet na rozhraní, které je portem bridge", correct: true },
                { text: "Pool je špatně definován", correct: false },
                { text: "Na rozhraní chybí IP adresa", correct: false }
            ],
            rationale: "Pokud je port v bridgi, DHCP server musí být nastaven na logickém rozhraní 'Bridge', nikoliv na fyzickém portu."
        },
        {
            // PDF Otázka 161 - Upraveno
            question: "Která pravidla NATu jsou správně popsána?",
            type: "multi",
            options: [
                { text: "DST-NAT: definuje novou cílovou adresu v lokální síti pro příchozí pakety (Port Forwarding)", correct: true },
                { text: "SRC-NAT: schovává lokální síť za veřejnou IP (Maškaráda)", correct: true }, // Toto je standardní definice, i když PDF má u Q161 divné možnosti, toto je technicky správně.
                { text: "DST-NAT: přesměrovává vše na router samotný", correct: false }
            ],
            rationale: "DST-NAT mění cílovou adresu (typicky z veřejné na privátní serveru). SRC-NAT mění zdrojovou (typicky z privátní na veřejnou)."
        },
        {
             // PDF Otázka 30
            question: "Jaký je výchozí port pro zabezpečený WinBox?",
            type: "single",
            options: [
                { text: "TCP 8291", correct: true },
                { text: "UDP 5678", correct: false },
                { text: "TCP 8080", correct: false }
            ],
            rationale: "WinBox používá port TCP 8291."
        },
        {
            question: "Jaký je rozdíl mezi Backup a Export?",
            type: "multi",
            options: [
                { text: "Backup je binární a nelze jej editovat", correct: true },
                { text: "Export je textový skript a lze jej editovat", correct: true },
                { text: "Backup obsahuje pouze hesla", correct: false }
            ],
            rationale: "PDF (otázka 75) potvrzuje: 'Backup files are not editable'."
        },
        {
            // PDF Otázka 138
            question: "Co je to Routing Loop (směrovací smyčka)?",
            type: "single",
            options: [
                { text: "Situace, kdy je paket směrován přes stejnou sekvenci routerů dokola, dokud nevyprší TTL", correct: true },
                { text: "Situace, kdy router zahodí paket", correct: false },
                { text: "Když paket nedorazí do cíle", correct: false }
            ],
            rationale: "Paket 'krouží' v síti a spotřebovává TTL."
        }
    ];

    // --- APP LOGIC ---

    let currentQuestionIndex = 0;
    let score = 0;
    let currentData = null;
    let userSelection = []; // Pro multi-select

    // DOM Elements
    const qText = document.getElementById('question-text');
    const optsCont = document.getElementById('options-container');
    const feedbackBox = document.getElementById('feedback-box');
    const feedbackText = document.getElementById('feedback-text');
    const nextBtn = document.getElementById('next-btn');
    const checkBtn = document.getElementById('check-btn');
    const progressBar = document.getElementById('progress-bar');
    const qCounter = document.getElementById('q-counter');
    const scoreCounter = document.getElementById('score-counter');
    const quizUI = document.getElementById('quiz-ui');
    const resultsUI = document.getElementById('results-ui');
    const finalScoreEl = document.getElementById('final-score');
    const finalScoreCircle = document.getElementById('final-score-circle');
    const finalMsg = document.getElementById('final-message');

    function initQuiz() {
        currentQuestionIndex = 0;
        score = 0;
        quizUI.style.display = 'block';
        resultsUI.style.display = 'none';
        updateStats();
        loadQuestion();
    }

    function loadQuestion() {
        // Reset UI
        feedbackBox.classList.remove('show');
        feedbackBox.style.display = 'none';
        nextBtn.style.display = 'none';
        checkBtn.style.display = 'none';
        optsCont.innerHTML = '';
        userSelection = [];

        if (currentQuestionIndex >= quizData.length) {
            showResults();
            return;
        }

        currentData = quizData[currentQuestionIndex];
        
        // Update Text
        qText.innerHTML = currentData.question + 
            (currentData.type === 'multi' ? "<br><small style='color:#666; font-weight:normal;'>(Vyberte všechny správné odpovědi)</small>" : "");

        // Render Options
        currentData.options.forEach((opt, index) => {
            const label = document.createElement('label');
            label.classList.add('option-label');
            
            const input = document.createElement('input');
            input.type = currentData.type === 'multi' ? 'checkbox' : 'radio';
            input.name = 'quiz-option';
            input.value = index;
            
            // Event Listener
            input.onchange = () => handleSelection(index, input, label);

            label.appendChild(input);
            label.appendChild(document.createTextNode(opt.text));
            optsCont.appendChild(label);
        });

        updateStats();
    }

    function handleSelection(index, input, label) {
        if (currentData.type === 'single') {
            // Single choice: immediate check
            submitAnswer(index, label);
        } else {
            // Multi choice: toggle selection, show check button
            if (input.checked) {
                userSelection.push(index);
            } else {
                userSelection = userSelection.filter(i => i !== index);
            }
            // Show "Check" button if at least one selected
            checkBtn.style.display = userSelection.length > 0 ? 'inline-block' : 'none';
        }
    }

    function submitAnswer(singleIndex = null, singleLabel = null) {
        let correctIndexes = [];
        currentData.options.forEach((opt, idx) => {
            if (opt.correct) correctIndexes.push(idx);
        });

        const labels = optsCont.querySelectorAll('.option-label');
        const inputs = optsCont.querySelectorAll('input');
        
        // Disable inputs
        labels.forEach(l => l.classList.add('disabled'));
        inputs.forEach(i => i.disabled = true);
        checkBtn.style.display = 'none';

        let isCorrect = false;

        if (currentData.type === 'single') {
            // Logic for Single
            const selectedOpt = currentData.options[singleIndex];
            isCorrect = selectedOpt.correct;

            if (isCorrect) {
                singleLabel.classList.add('correct');
                score++;
                feedbackText.innerHTML = "<strong>Správně!</strong> " + (currentData.rationale || "");
            } else {
                singleLabel.classList.add('wrong');
                // Highlight correct
                labels[correctIndexes[0]].classList.add('correct');
                feedbackText.innerHTML = "<strong>Chyba.</strong> Správná odpověď: " + currentData.options[correctIndexes[0]].text + ".<br>" + (currentData.rationale || "");
            }

        } else {
            // Logic for Multi
            // Check if user selection matches correct indexes exactly
            userSelection.sort();
            correctIndexes.sort();
            
            const isMatch = JSON.stringify(userSelection) === JSON.stringify(correctIndexes);
            
            if (isMatch) {
                isCorrect = true;
                score++;
                feedbackText.innerHTML = "<strong>Výborně!</strong> Máte všechna správná pole.<br>" + (currentData.rationale || "");
            } else {
                isCorrect = false;
                feedbackText.innerHTML = "<strong>Neúplné nebo chybné.</strong><br>" + (currentData.rationale || "");
            }

            // Visual Feedback for Multi
            labels.forEach((lbl, idx) => {
                const isSelected = userSelection.includes(idx);
                const isActuallyCorrect = correctIndexes.includes(idx);

                if (isSelected && isActuallyCorrect) {
                    lbl.classList.add('correct'); // User selected correct
                } else if (isSelected && !isActuallyCorrect) {
                    lbl.classList.add('wrong'); // User selected wrong
                } else if (!isSelected && isActuallyCorrect) {
                    lbl.classList.add('missed'); // User missed this correct one
                }
            });
        }

        feedbackBox.style.display = 'block';
        setTimeout(() => feedbackBox.classList.add('show'), 10);
        nextBtn.style.display = 'inline-block';
        scoreCounter.textContent = `Skóre: ${score}`;
    }

    function nextQuestion() {
        currentQuestionIndex++;
        loadQuestion();
    }

    function updateStats() {
        qCounter.textContent = `Otázka ${currentQuestionIndex + 1} / ${quizData.length}`;
        const pct = ((currentQuestionIndex) / quizData.length) * 100;
        progressBar.style.width = `${pct}%`;
    }

    function showResults() {
        quizUI.style.display = 'none';
        resultsUI.style.display = 'block';
        const pct = Math.round((score / quizData.length) * 100);
        finalScoreEl.textContent = `${pct}%`;
        
        const color = pct >= 80 ? '#10ac84' : (pct >= 50 ? '#ff9f43' : '#ee5253');
        finalScoreCircle.style.background = `conic-gradient(${color} ${pct}%, #e0e0e0 ${pct}%)`;
        finalScoreCircle.style.color = color;

        if(pct === 100) finalMsg.textContent = "Perfektní! Jste připraveni.";
        else if(pct > 80) finalMsg.textContent = "Skvělá práce.";
        else finalMsg.textContent = "Doporučuji projít otázky znovu.";
    }

    initQuiz();

</script>
</body>
</html>
